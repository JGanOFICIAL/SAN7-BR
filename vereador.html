<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Prefeitura de João Câmara — Vereadores</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --header-h:64px;
    --search-h:160px; /* espaço maior p/ área com imagem */
    --max-w:900px;
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;width:100%;font-family:"Public Sans",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  body{
    min-height:100vh;
    background:#fff;
    background-image:url("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQM-JuQwVaQIYwKRl4Tr1Y82SzgpVltIcOR74Xauduq6QDql9cQFOzRK5e_&s=10");
    background-size:cover;background-position:center;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    color:#0a1733;
  }

  /* Header */
  header{
    position:fixed;
    top:0;left:0;right:0;
    height:var(--header-h);
    z-index:1100;
    background:#fff;color:#333;
    display:flex;align-items:center;justify-content:space-between;
    padding:12px 18px;box-shadow:0 2px 6px rgba(0,0,0,.08);
  }
  header .logo{display:flex;align-items:center;gap:12px}
  header .logo img{width:44px;height:44px;object-fit:contain;border-radius:8px}
  header .logo div{display:flex;flex-direction:column}
  header strong{font-size:15px}
  header small{font-size:13px;color:#444}
  .btn-back{
    background:#0b2b6b;color:#fff;
    width:40px;height:40px;
    display:flex;align-items:center;justify-content:center;
    text-decoration:none;font-size:20px;border:none;border-radius:6px;
  }

  /* Bloco do topo com imagem */
  .top-area{
    position:sticky;
    top:var(--header-h);
    z-index:1050;
    height:var(--search-h);
    background:url("top-bg.jpg") center/cover no-repeat; /* coloque aqui a imagem */
    display:flex;flex-direction:column;align-items:center;justify-content:flex-end;
    padding:18px;
  }

  .search{
    width:100%;
    max-width:var(--max-w);
    display:flex;align-items:center;gap:12px;
    background:#fff;padding:12px 16px;border-radius:14px;
    box-shadow:0 8px 30px rgba(10,42,102,.08);
  }
  .search input{
    flex:1;border:0;font-size:16px;padding:8px;
    background:transparent;outline:none;color:#1b2b3a;
  }
  .search input::placeholder{color:#bfc7cf}
  .search .badge{
    font-size:13px;padding:8px 10px;border-radius:10px;
    background:#0b2b6b;color:#fff;font-weight:700;min-width:36px;text-align:center;
  }

  /* Main content */
  .vereador-container{
    margin:0 auto;
    max-width:var(--max-w);
    padding:20px;
    margin-top: calc(var(--header-h) + var(--search-h));
    background:linear-gradient(180deg,#0b2b6b 0%,#041739 100%);
    color:#fff;
    min-height:calc(100vh - (var(--header-h) + var(--search-h)));
  }

  h2{font-size:22px;font-weight:700;margin:0 0 6px;color:#fff}
  p{font-size:15px;margin:0 0 18px;color:rgba(255,255,255,.9)}

  .grid{
    display:grid;
    grid-template-columns:1fr;
    gap:22px;
    padding:6px 0;
  }

  .card{
    background:#fff;color:#0a1733;border-radius:14px;padding:20px;
    display:flex;flex-direction:column;align-items:center;gap:12px;text-align:center;
    box-shadow:0 8px 18px rgba(2,17,44,.12);
    transition:transform .18s ease,box-shadow .18s ease;
  }
  .card:hover{transform:translateY(-6px);box-shadow:0 14px 30px rgba(2,17,44,.18)}
  .avatar{width:110px;height:110px;border-radius:50%;object-fit:cover;box-shadow:0 6px 18px rgba(0,0,0,.12);border:6px solid #fff}
  .name{font-weight:800;font-size:20px;margin-top:4px}
  .meta{font-size:15px;color:#4b5a7a}

  .actions{display:flex;flex-direction:column;gap:12px;width:100%;align-items:center;margin-top:6px}
  .actions .btn{width:160px;max-width:80%;border:1px solid #d3dbea;background:#f2f6ff;padding:10px 14px;font-weight:700;border-radius:10px;color:#002f6c;text-decoration:none}
  .actions .btn:hover{background:#e6edff}

  .rodape{margin-top:28px;text-align:center;font-size:13px;color:rgba(255,255,255,.85)}

  .loading{position:fixed;inset:0;background:#0a1733cc;backdrop-filter:blur(3px);display:none;align-items:center;justify-content:center;z-index:2000}
  .spinner{width:64px;height:64px;border:6px solid #ffffff33;border-top-color:#fff;border-radius:50%;animation:spin .9s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
  .toast{position:fixed;right:16px;bottom:16px;display:flex;flex-direction:column;gap:10px;z-index:3000}
  .toast .item{background:#002f6c;color:#fff;padding:12px 16px;border-radius:8px}

  @media(min-width:1000px){
    :root{--max-w:1000px}
    .card{flex-direction:row;align-items:center;text-align:left;gap:22px;padding:26px}
    .avatar{width:120px;height:120px}
    .actions{align-items:flex-start}
  }
  @media(max-width:420px){
    :root{--search-h:120px}
    header{height:56px}
    .search input{font-size:15px}
    .card{padding:16px}
    .avatar{width:96px;height:96px}
  }
</style>
</head>
<body>
  <header>
    <div class="logo">
      <img id="logoHeader" src="" alt="Logo">
      <div>
        <strong>Vereadores</strong>
        <small>Câmara Municipal de João Câmara</small>
      </div>
    </div>
    <a href="perfil.html" class="btn-back" aria-label="Voltar">←</a>
  </header>

  <div class="top-area">
    <div class="search" role="search" aria-label="Pesquisar vereadores">
      <input id="q" type="search" placeholder="Pesquise vereadores por nome…" aria-label="Pesquisar vereadores por nome"/>
      <span id="count" class="badge" aria-live="polite">0</span>
    </div>
  </div>
  <main class="vereador-container" id="main">
    <h2 id="heroTitle">Bem-vindos!</h2>
    <p id="heroDesc">Conheça os vereadores do município</p>

    <section class="grid" id="lista" aria-live="polite"></section>

    <div class="rodape">© Câmara Municipal de João Câmara - <span id="ano"></span></div>
  </main>

  <div class="loading" id="loading"><div class="spinner" role="status" aria-hidden="false"></div></div>
  <div class="toast" id="toast" aria-live="polite"></div>

  <div vw class="enabled"><div vw-access-button class="active"></div><div vw-plugin-wrapper><div class="vw-plugin-top-wrapper"></div></div></div>
  <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
  <script>new window.VLibras.Widget('https://vlibras.gov.br/app');</script>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <script src="script.js"></script>

  <script>
    document.getElementById('ano').textContent = new Date().getFullYear();

    const $ = s => document.querySelector(s);
    const showLoad = (v = true) => $("#loading").style.display = v ? "flex" : "none";
    const toast = m => { const el = document.createElement("div"); el.className = "item"; el.textContent = m; $("#toast").appendChild(el); setTimeout(()=>el.remove(),3800); };

    const state = { vereadores: [], filtros: "" };

    function render(){
      const term = (state.filtros||"").toLowerCase();
      const data = state.vereadores.filter(v => (v.nome||"").toLowerCase().includes(term));
      $("#count").textContent = data.length;
      $("#lista").innerHTML = data.map(v => `
        <article class="card" role="article">
          <img class="avatar" src="${v.fotoUrl||''}" alt="Foto de ${v.nome||''}" onerror="this.src=''"/>
          <div class="content">
            <div class="name">${v.nome||''}</div>
            <div class="meta">${v.partido?`Partido: ${v.partido}`:''}</div>
            <div class="actions">
              <a class="btn" href="arquivo.html?id=${encodeURIComponent(v.id)}">Ver perfil</a>
              ${v.insta?`<a class="btn" target="_blank" rel="noopener" href="https://instagram.com/${v.insta.replace('@','')}">@Insta</a>`:''}
            </div>
          </div>
        </article>
      `).join("") || `<div style="color:#fff;padding:18px">Nenhum vereador encontrado.</div>`;
    }

    $("#q").addEventListener("input", e => { state.filtros = e.target.value; render(); });

    showLoad(true);
    window.addEventListener("load", ()=>{
      try{
        const db = firebase.database();
        const cfgRef = db.ref("/config");
        cfgRef.on("value", snap=>{
          const c = snap.val() || {};
          $("#logoHeader").src = c.logoUrl || "";
          $("#heroTitle").textContent = c.heroTitle || "Bem-vindos!";
          document.getElementById("heroDesc").textContent = c.heroDesc || "Conheça os vereadores do município";
        });

        const ref = db.ref("/vereadores");
        ref.on("value", snap=>{
          const val = snap.val() || {};
          state.vereadores = Object.keys(val).map(id => ({ id, ...val[id] })).sort((a,b)=>(a.nome||"").localeCompare(b.nome||""));
          render(); showLoad(false); toast("Lista de vereadores atualizada.");
        }, err=>{
          showLoad(false); toast("Falha ao carregar vereadores."); console.error(err);
        });
      }catch(e){
        showLoad(false); toast("Erro de inicialização Firebase."); console.error(e);
      }
    });
  </script>
</body>
</html>