<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Prefeitura de João Câmara — Perfil</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Rawline:wght@400;600;700&family=Public+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--gov-azul:#B40000;--gov-amarelo:#FFCD00;--gov-branco:#fff;--gov-verde:#168821;--cinza:#f6f7f9;--sombra:0 10px 30px rgba(0,0,0,.08)}
  body{margin:0;background:var(--cinza);color:#1f1f1f;font-family:"Public Sans","Rawline",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  header{position:sticky;top:0;background:var(--gov-azul);color:#fff;padding:14px 18px;display:flex;align-items:center;justify-content:space-between;box-shadow:var(--sombra);z-index:10}
  .esq{display:flex;align-items:center;gap:12px}
  .logo{width:44px;height:44px;background:#fff;border-radius:6px}
  .saud{display:flex;flex-direction:column}
  .saud strong{font-size:18px}
  .btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 14px;border:none;border-radius:12px;font-weight:700;cursor:pointer}
  .btn-sair{background:#ffeaea;color:#6b0b0b}
  main{max-width:1040px;margin:24px auto;padding:0 16px}
  .cards{display:grid;grid-template-columns:1fr 1fr;gap:16px}
  @media (max-width:900px){.cards{grid-template-columns:1fr}}
  .card{background:var(--gov-branco);border-radius:12px;box-shadow:var(--sombra);padding:20px}
  .acoes{display:flex;gap:10px;flex-wrap:wrap}
  .btn-acao{background:var(--gov-verde);color:#fff}
  .btn-acao.sec{background:#fffae6;color:#584300;border:1px solid #ffe08a}
  .link{display:inline-flex;align-items:center;gap:8px;text-decoration:none}
  /* Modal */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.42);display:none;align-items:center;justify-content:center;padding:12px;z-index:50}
  .modal{
    width:min(720px,100%);max-height:80vh;overflow:auto;background:#fff;border-radius:16px;box-shadow:var(--sombra);padding:18px 18px 22px
  }
  .mhead{display:flex;align-items:center;justify-content:space-between;gap:8px;position:sticky;top:0;background:#fff}
  .mclose{border:none;background:#f1f3f5;border-radius:10px;padding:10px;cursor:pointer;font-weight:700}
  label{font-weight:600}
  input{width:100%;padding:12px;border:1px solid #dfe3eb;border-radius:12px;font-size:16px;outline:none}
  input:focus{border-color:#e2b9b9;box-shadow:0 0 0 4px rgba(180,0,0,.12)}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  @media (max-width:700px){.grid{grid-template-columns:1fr}}
  .btn-save{background:var(--gov-azul);color:#fff}
  .spinner{width:18px;height:18px;border:3px solid rgba(255,255,255,.4);border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite;margin-right:8px}
  @keyframes spin{to{transform:rotate(360deg)}}
  .chip{display:inline-block;background:#ffeaea;color:#6b0b0b;border-radius:999px;padding:6px 10px;font-size:12px;border:1px solid #ffd6d6}
</style>
</head>
<body>
  <header>
  <div class="esq">
    <div class="logo">
      <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQpN6mG9JrV3AvmACLq0uOQb0OcGFLu4WW8sOckbZpA8ow2biqC-IxosxA&s=10" alt="Logomarca" style="max-width:100%;max-height:100%;object-fit:contain;border-radius:6px;display:block;margin:auto;">
    </div>
    <div class="saud">
      <small>Prefeitura de João Câmara/RN</small>
      <strong id="saudacao">Olá, Cidadão!</strong>
    </div>
  </div>
</header>
<div id="reclamacao-form">
  <form id="formulario">
    <h2>Envie sua mensagem</h2>
    <p>Preencha os campos abaixo para registrar sua sugestão ou reclamação.</p>
    <input type="text" id="nome" placeholder="SEU NOME OU ANÔNIMO" required />
    <input type="text" id="endereco" placeholder="ENDEREÇO" required />
    <input type="text" id="rua" placeholder="NOME DA RUA" required />
    <textarea id="problema" placeholder="ESCREVA SUA MENSAGEM" required></textarea>
    <div class="btn-wrapper">
      <button type="submit" id="btnEnviar">Enviar</button>
    </div>
  </form>
  <div id="mensagem-sucesso" style="display:none;">
    <img id="imgSucesso" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS3gyj1Jg6mOWW0K0kekpzrNHDjjKetnM-TzrdhAFfuESVDkWUubTpgqQVw&s=10" alt="Sucesso" />
    <p>Mensagem enviada com sucesso!</p>
  </div>
</div>
<style>
#reclamacao-form {
  background: transparent;
  font-family: Arial, sans-serif;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
}
#formulario {
  display: flex;
  flex-direction: column;
  gap: 14px;
  width: 100%;
  max-width: 420px;
  background: #fff;
  padding: 24px;
  border-radius: 6px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}
#formulario h2 {
  margin: 0;
  font-size: 22px;
  color: #660000;
}
#formulario p {
  margin: 0 0 14px 0;
  font-size: 15px;
  color: #444;
}
#formulario input, #formulario textarea {
  border: none;
  border-bottom: 2px solid #ccc;
  padding: 10px 5px;
  outline: none;
  resize: none;
  font-size: 16px;
  width: 100%;
}
#formulario input:focus, #formulario textarea:focus {
  border-bottom: 2px solid #B40000;
}
.btn-wrapper {
  display: flex;
  justify-content: flex-start;
}
#btnEnviar {
  background: transparent;
  color: #B40000;
  border: 2px solid #B40000;
  font-weight: bold;
  padding: 10px 18px;
  font-size: 15px;
  cursor: pointer;
  border-radius: 4px;
  transition: 0.3s;
}
#btnEnviar:hover {
  background: #B40000;
  color: #fff;
}
#btnEnviar:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}
#mensagem-sucesso {
  text-align: center;
  margin-top: 20px;
}
#mensagem-sucesso img {
  max-width: 120px;
  margin-bottom: 10px;
}
</style>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCAlWxc7YxTMcTLCECUDuYfomO6QapreqY",
    authDomain: "login-you-see.firebaseapp.com",
    databaseURL: "https://login-you-see-default-rtdb.firebaseio.com",
    projectId: "login-you-see",
    storageBucket: "login-you-see.firebasestorage.app",
    messagingSenderId: "524877259374",
    appId: "1:524877259374:web:9ff66b67c9c5bf0bb07c7f",
    measurementId: "G-K7E00VXYHG"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const form = document.getElementById("formulario");
  const btn = document.getElementById("btnEnviar");
  const sucesso = document.getElementById("mensagem-sucesso");
  const imgSucesso = document.getElementById("imgSucesso");

  imgSucesso.src = "https://images.vexels.com/media/users/3/153973/isolated/preview/3f4756f5a915c254517d7f0800910ad6-icone-de-traco-colorido-do-documento-verificado.png";

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    btn.textContent = "Carregando...";
    btn.disabled = true;

    const dados = {
      nome: document.getElementById("nome").value,
      endereco: document.getElementById("endereco").value,
      rua: document.getElementById("rua").value,
      problema: document.getElementById("problema").value,
      data: new Date().toISOString()
    };

    try {
      await push(ref(db, "reclamacoes"), dados);
      form.style.display = "none";
      sucesso.style.display = "block";
    } catch (err) {
      alert("Erro ao enviar: " + err);
    } finally {
      btn.textContent = "Enviar";
      btn.disabled = false;
    }
  });
</script>
  <div vw class="enabled">
    <div vw-access-button class="active"></div>
    <div vw-plugin-wrapper><div class="vw-plugin-top-wrapper"></div></div>
  </div>
  <script src="https://vlibras.gov.br/app/vlibras-plugin.js"></script>
  <script>new window.VLibras.Widget('https://vlibras.gov.br/app');</script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>
    protegerPagina();
    onAuthReady(async (user)=>{
      const perfil = await obterPerfil(user.uid);
      const primeiroNome = (perfil?.nomeCompleto||'Cidadão').split(' ')[0];
      document.getElementById('saudacao').textContent = `Olá, ${primeiroNome}!`;
      document.getElementById('resumo').innerHTML = `
        <div><strong>Nome:</strong> ${perfil?.nomeCompleto||'-'}</div>
        <div><strong>CPF:</strong> ${perfil?.cpf||'-'}</div>
        <div><strong>Nascimento:</strong> ${perfil?.nascimento||'-'}</div>
        <div><strong>Telefone:</strong> ${perfil?.telefone||'-'}</div>
        <div><strong>Endereço:</strong> ${formatEndereco(perfil?.endereco)}</div>
      `;
      document.getElementById('btnEventos').href = '#/eventos-municipais';
      document.getElementById('btnEditais').href = '#/editais';
    });
  </script>
</body>
</html>
<style>
  #telaCarregamento {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backdrop-filter: blur(12px);
    background: rgba(0, 0, 0, 0.55);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    transition: opacity 0.3s ease;
  }
  .carregandoBox {
    width: 160px;
    padding: 30px 20px;
    background: #fff;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    box-shadow: 0 6px 25px rgba(0,0,0,0.25);
    font-family: "Arial", sans-serif;
  }
  .spinner {
    width: 60px;
    height: 60px;
    border: 5px solid #B40000;
    border-top: 5px solid transparent;
    border-radius: 50%;
    animation: girar 2.5s linear infinite;
    margin-bottom: 20px;
  }
  @keyframes girar {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  .carregandoBox span {
    font-size: 17px;
    color: #B40000;
    font-weight: bold;
    text-align: center;
  }
</style>
<div id="telaCarregamento">
  <div class="carregandoBox">
    <div class="spinner"></div>
    <span>carregando...</span>
  </div>
</div>
<script>
  setTimeout(() => {
    const tela = document.getElementById('telaCarregamento');
    tela.style.opacity = '0';
    setTimeout(() => { tela.style.display = 'none'; }, 300);
  }, 3000);
</script>
<a href="perfil.html" id="btnRodape">← VOLTAR</a>
<style>
  #btnRodape{
    position:fixed;
    bottom:0;
    left:0;
    right:0;
    background:var(--gov-azul,#B40000);
    color:#fff;
    font-weight:700;
    font-size:18px;
    text-align:center;
    padding:16px;
    text-decoration:none;
    box-shadow:0 -3px 12px rgba(0,0,0,.2);
    z-index:2000;
    transition:background .25s ease;
  }
  #btnRodape:hover{
    background:#6b0b0b;
  }
</style>
