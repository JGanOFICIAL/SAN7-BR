<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
:root{
--green:#9CCC65;
--dark:#111;
--light:#fff;
--border:#ccc;
--bg-url:url('https://c2a6771173.cbaul-cdnwnd.com/4f0c8b93cda84ae8665e2b589652cf30/200000035-6240c6240e/700/24B77FF0-45F8-444B-9BF7-74B3B06B2E86.webp?ph=c2a6771173');
--logo-url:url('https://c2a6771173.cbaul-cdnwnd.com/4f0c8b93cda84ae8665e2b589652cf30/200000005-62d7c62d7e/700/9A9000A9-FCA5-4306-876F-28C2D3211763.webp');
/* Novas variáveis para modernização */
--primary-color: #4CAF50; /* Verde principal para botões */
--secondary-color: #2196F3; /* Azul para destaque secundário */
--danger-color: #F44336; /* Vermelho para exclusão */
--card-bg: rgba(255, 255, 255, 0.95);
/* Cor Laranja Firebase para o estilo da tag/laminado de dia (fallback/dia único) */
--firebase-orange: #FF9100; 
}
body{
font-family:Inter,Arial,sans-serif;
margin:0;
padding:0;
background-image:var(--bg-url);
background-size:cover;
background-position:center;
background-attachment:fixed;
color:var(--dark);
}
header{
position:fixed;
top:0;
left:0;
right:0;
height:60px;
background:#fff;
border-bottom:2px solid #ccc;
display:flex;
align-items:center;
padding:0 15px;
z-index:10;
}
.logo{
width:140px;
height:40px;
background-image:var(--logo-url);
background-size:contain;
background-repeat:no-repeat;
background-position:left;
}
header button {
    border-radius: 0 !important; /* Retangular */
}
main{
padding:80px 15px 160px;
max-width:800px;
margin:auto;
}
/* Estilo Quadrado/Retangular: Área de seleção e pesquisa */
.search-box{
width:100%;
padding:10px 12px;
border:1px solid var(--border);
font-size:16px;
outline:none;
margin-bottom:15px;
border-radius:0; /* Retangular */
}
.group{
margin-bottom:15px;
border:1px solid var(--border);
background:var(--card-bg);
backdrop-filter:blur(5px);
box-shadow:0 4px 12px rgba(0,0,0,0.1); 
border-radius: 8px; 
overflow: hidden; 
}
.group-header{
background:#f0f0f0;
padding:12px;
cursor:pointer;
font-weight:bold;
display: flex;
justify-content: space-between;
align-items: center;
}
.exercise-list{
display:none;
padding:10px;
}
.exercise-item{
display:flex;
align-items:flex-start; 
justify-content:space-between;
border-bottom:1px solid #eee;
padding:12px 0; 
flex-wrap:wrap;
gap: 10px; 
}
.exercise-item > span {
    font-weight: 500;
    flex-grow: 1; 
    max-width: 40%;
}
.exercise-item > div {
    display: flex;
    flex-direction: column;
    gap: 5px;
    align-items: flex-end;
    flex-grow: 2;
    max-width: 55%;
}
.checkbox-modern{
width:24px;
height:24px;
border:2px solid #555;
display:inline-block;
cursor:pointer;
position:relative;
transition:.3s;
box-sizing:border-box;
border-radius: 0; /* Retangular */
min-width: 24px;
}
.checkbox-modern.active{
background:var(--green);
border-color:var(--green);
}
.checkbox-modern::after{
content:'';
position:absolute;
top:50%;
left:50%;
width:8px;
height:8px;
background:#fff;
transform:translate(-50%,-50%) scale(0);
border-radius: 0; /* Retangular */
transition:.2s;
}
.checkbox-modern.active::after{
transform:translate(-50%,-50%) scale(1);
}
/* INPUTS COM BORDA QUADRADA/RETANGULAR */
input.reps,input.series,input.duration,
.day-select,.intensity-select{
padding:5px;
border:1px solid:#ccc;
font-size:14px;
text-align:center;
margin-left:0;
border-radius:0; /* Retangular */
outline:none;
box-sizing: border-box;
flex-grow: 1;
}
input.reps,input.series,input.duration {
    max-width: 65px;
}
.day-select,.intensity-select{
    max-width: 100%;
}
.input-row {
    display: flex;
    gap: 5px;
    width: 100%;
    justify-content: flex-end;
}
.obs{
width:100%;
margin-top:5px;
padding:8px;
border:1px solid #ccc;
font-size:14px;
outline:none;
border-radius:0; /* Retangular */
resize: vertical;
}
footer{
position:fixed;
bottom:20px;
left:50%;
transform:translateX(-50%);
display:flex;
justify-content:center;
gap:15px; 
padding:0 10px;
z-index:5;
width: 90%;
max-width: 400px;
}
.bottom-btn{
background:var(--green);
color:#fff;
border:none;
font-weight:bold;
padding:12px 25px;
cursor:pointer;
font-size:16px;
box-shadow:0 4px 15px rgba(0,0,0,0.2);
width:50%; 
text-align:center;
transition:.3s;
border-radius: 0; /* Botão Retangular */
}
.bottom-btn:hover{background:#7cb342;}

/* --- INÍCIO DA MODERNIZAÇÃO: ÁREA MEUS TREINOS (OVERLAY) e PRÉVIA --- */

.overlay{
position:fixed;
top:0;
left:0;
right:0;
bottom:0;
background:rgba(255,255,255,0.98); 
display:none;
overflow:auto;
padding:20px 15px; 
color:var(--dark);
z-index:20;
}
.overlay h2{
text-align:center;
margin: 40px 0 20px; 
font-size: 24px;
color: var(--dark);
}

/* Botão EXCLUIR TUDO */
#clearAll{
display:block;
margin:10px auto 30px; 
padding:10px 20px;
background:var(--danger-color);
color:#fff;
border:none;
cursor:pointer;
font-weight:bold;
border-radius: 0; /* Retangular */
transition: background 0.3s;
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
#clearAll:hover {
    background: #d32f2f;
}

/* Container do Treino (Card) */
.day-section{
border:1px solid #ddd; /* Adiciona borda leve para separar */
margin-bottom:15px;
background:#fff;
box-shadow:0 6px 16px rgba(0,0,0,0.15); 
border-radius: 0; /* Retangular */
overflow: hidden;
}

/* Título do Dia (Estilo Laminado/Tag) */
.day-title{
padding:10px 15px;
font-weight:bold;
color:#fff;
text-transform: uppercase;
font-size: 16px;
/* Estilo laminado/tag */
box-shadow: 0 2px 5px rgba(0,0,0,0.15); 
position: relative;
z-index: 1;
}

/* Item do Exercício */
.exercise-entry{
padding:15px; 
border-top:1px solid #eee;
display:flex;
justify-content:space-between;
align-items:flex-start; /* Alinha o texto ao topo */
position: relative; 
}
.exercise-entry:last-child {
    border-bottom: none;
}
.exercise-entry div.details-container {
    max-width: calc(100% - 70px); /* Espaço para botões de ordem e exclusão */
}
.exercise-entry strong {
    font-size: 16px;
    color: var(--dark);
    line-height: 1.4;
}
.exercise-details {
    font-size: 14px;
    color: #555;
    margin-top: 4px;
}
.exercise-details strong {
    font-weight: bold; /* Garante que 'OBS' seja bold */
    color: #333;
}

/* Botões de Reordenação e Exclusão */
.action-buttons {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px; /* Espaço entre os botões */
    position: absolute;
    right: 15px;
    top: 10px;
}
.move-btn {
    background: none;
    color: var(--secondary-color);
    border: 1px solid var(--secondary-color);
    padding: 2px 5px;
    font-size: 12px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
    width: 25px;
    height: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    border-radius: 4px;
}
.move-btn:hover:not(:disabled) {
    background: var(--secondary-color);
    color: #fff;
}
.move-btn:disabled {
    opacity: 0.3;
    cursor: not-allowed;
    border-color: #ddd;
    color: #aaa;
}
.delete-btn{
    background: none;
    color: var(--danger-color);
    border: none;
    padding: 0;
    font-weight: normal;
    cursor:pointer;
    transition:.3s;
    font-size: 20px;
    width: 30px;
    height: 30px;
    border-radius: 50%; 
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1;
    margin-top: 5px;
}
.delete-btn::before {
    content: '×'; 
    font-weight: bold;
    display: block;
    transform: translateY(-1px);
}
.delete-btn:hover{
    background: rgba(244, 67, 54, 0.1); 
    color: var(--danger-color);
}

.close-btn{
position:fixed;
top:15px;
right:15px;
background:none;
color:var(--dark); 
font-size:32px; 
border:none;
font-weight:100; 
cursor:pointer;
z-index:25;
}
/* Estilo específico para o overlay de Prévia */
#previewOverlay {
    z-index: 30; /* Fica acima do overlay de MEUS TREINOS */
    padding-top: 60px; /* Ajusta espaço para o botão X */
}
#previewOverlay h2 {
    margin-top: 0;
}

/* NOVO: Estilo para o Overlay de Consulta */
#queryOverlay {
    z-index: 50; /* Fica acima de tudo */
    padding-top: 60px;
}
#queryOverlay h2 {
    margin-top: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}
#queryOverlay .consulted-na {
    font-size: 18px;
    color: #555;
    font-weight: normal;
}
#queryOverlay .day-title {
    background: var(--secondary-color) !important; /* Cor de destaque para o treino consultado */
}

/* NOVO: Estilo do Spinner de Carregamento */
.spinner {
  display: none; /* Escondido por padrão */
  width: 40px;
  height: 40px;
  border: 4px solid rgba(0, 0, 0, 0.1);
  border-left-color: var(--secondary-color);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 30px auto;
}

@keyframes spin {
  to {
    transform: rotate(360deg);
  }
}

/* --- FIM DA MODERNIZAÇÃO: ÁREA MEUS TREINOS (OVERLAY) e PRÉVIA --- */


/* Estilos Cardio (Mantidos) */
#cardioBtn {
    border-radius: 0; /* Retangular */
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}
#cardioOverlay {
    background: #fff;
    z-index: 40;
}
#closeCardio {
    color: var(--dark);
}
#newCardio, #saveCardio {
    border-radius: 0; /* Retangular */
    box-shadow: none;
    width: 100%;
}
.cardio_area_custom {
    display: flex;
    width: 100%;
    justify-content: center;
    gap: 12px;
    margin-top: 18px;
    font-size: 13px;
    font-weight: 600;
    color: white;
    user-select: none;
    text-align: center;
}
.cardio_item_custom {
    cursor: pointer;
    max-width: 135px;
    line-height: 17px;
}
.cardio_divider_custom {
    opacity: 0.5;
    color: white;
}
.cardio_overlay_custom {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    display: none;
    justify-content: center;
    align-items: flex-start;
    padding-top: 60px;
    padding-left: 18px;
    padding-right: 18px;
    z-index: 999999;
}
.cardio_box_custom {
    width: 100%;
    max-width: 420px;
    font-size: 14px;
    font-weight: 500;
    color: black;
    line-height: 20px;
}
.cardio_close_custom {
    position: fixed;
    top: 15px;
    right: 15px;
    font-size: 22px;
    font-weight: 900;
    cursor: pointer;
    user-select: none;
    color: black;
}
/* Inputs e selects do Cardio com borda quadrada */
#diaCardio, .tempo, .quando, .obsC {
    border-radius: 0 !important;
}

/* Novo estilo para o formulário de consulta NA */
#queryNAForm {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
    padding: 10px;
    border: 1px solid var(--border);
    background: var(--card-bg);
    border-radius: 0;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}
#inputNA {
    flex-grow: 1;
    border-radius: 0;
}
#consultarBtn {
    background: var(--secondary-color);
    color: #fff;
    border: none;
    padding: 10px 15px;
    font-weight: bold;
    cursor: pointer;
    border-radius: 0;
    transition: background 0.3s;
}
#consultarBtn:hover {
    background: #1e88e5;
}
</style>
</head>

<body>
<header>
  <div class="logo"></div>
  <button onclick="document.getElementById('queryNAOverlay').style.display='block'; document.getElementById('inputNA').focus();" style="background-color:var(--secondary-color);color:#fff;border:none;width:120px;height:35px;position:absolute;top:50%;right:100px;transform:translateY(-50%);font-weight:bold;cursor:pointer;">COPIAR TREINO DE ALGUEM</button>
  <button onclick="window.location.href='index.html'" style="background-color:#8DC63F;color:#fff;border:none;width:70px;height:35px;position:absolute;top:50%;right:10px;transform:translateY(-50%);font-weight:bold;cursor:pointer;">Voltar</button>
</header>







<br><br><br><br><br>








<button id="cardioBtn" class="bottom-btn" style="width:95%;margin:0 auto;display:block;background:#fff;color:#000;border:1px solid #ccc;">VER MEU CARDIO</button>

<div id="cardioOverlay" class="overlay" style="background:#fff;display:none;padding:80px 20px;z-index:40;">
<button id="closeCardio" class="close-btn" style="color:#000;">×</button>
<h2 style="text-align:center;margin-bottom:20px;">CARDIO</h2>

<div id="cardioDias"></div>

<button id="newCardio" class="bottom-btn" style="width:95%;margin:20px auto 0 auto;display:block;background:#fff;color:#000;border:1px solid #ccc;">CRIAR</button>

<div id="cardioForm" style="display:none;margin-top:20px;border:1px solid #ccc;padding:15px;background:#fafafa;border-radius: 0;"> <select id="diaCardio" style="width:100%;padding:10px;font-size:16px;border:1px solid #ccc;border-radius: 0;"> <option>SEGUNDA</option><option>TERÇA</option><option>QUARTA</option>
<option>QUINTA</option><option>SEXTA</option><option>SÁBADO</option><option>DOMINGO</option>
</select>

<div style="margin-top:10px;width:100%;padding:10px;border:1px solid #ccc;border-radius: 0;"> <label style="font-weight:bold;">SELECIONAR MÁQUINAS</label>
<div>
<label><input type="checkbox" class="maq" value="Esteira"> ESTEIRA</label><br>
<label><input type="checkbox" class="maq" value="Bicicleta"> BICICLETA</label><br>
<label><input type="checkbox" class="maq" value="Elíptico"> ELÍPTICO</label>
</div>
</div>

<div id="maqInputs"></div>

<button id="saveCardio" class="bottom-btn" style="width:95%;margin:15px auto 0 auto;display:block;background:#000;color:#fff;border:1px solid #000;">SALVAR</button>
</div>
</div>

<script>
const IMG_ESTEIRA = "https://img.freepik.com/vetores-premium/icone-preto-de-batimento-cardiaco-sinal-de-cardio-simbolo-de-saude_53562-19766.jpg?w=360";
const IMG_BICICLETA = "https://img.freepik.com/vetores-premium/icone-preto-de-batimento-cardiaco-sinal-de-cardio-simbolo-de-saude_53562-19766.jpg?w=360";
const IMG_ELIPTICO = "https://img.freepik.com/vetores-premium/icone-preto-de-batimento-cardiaco-sinal-de-cardio-simbolo-de-saude_53562-19766.jpg?w=360";

// CORES FIXAS POR DIA (Mantido como no seu código para o CARDIO)
const coresCardio={
"SEGUNDA":"#4caf50",
"TERÇA":"#2196f3",
"QUARTA":"#ff9800",
"QUINTA":"#9c27b0",
"SEXTA":"#f44336",
"SÁBADO":"#009688",
"DOMINGO":"#607d8b"
};

const imgsFixas={
"Esteira":IMG_ESTEIRA,
"Bicicleta":IMG_BICICLETA,
"Elíptico":IMG_ELIPTICO
};

document.getElementById("cardioBtn").onclick=()=>{document.getElementById("cardioOverlay").style.display="block";loadCardio();};
document.getElementById("closeCardio").onclick=()=>{document.getElementById("cardioOverlay").style.display="none";};

function loadCardio(){
const dias=["SEGUNDA","TERÇA","QUARTA","QUINTA","SEXTA","SÁBADO","DOMINGO"];
db.ref("cardio/"+na).get().then(s=>{
let data=s.exists()?s.val():[];
let box=document.getElementById("cardioDias");
box.innerHTML="";
dias.forEach(d=>{
let items=data.filter(x=>x.dia===d);
let cor=coresCardio[d];
let div=document.createElement("div");
div.style.border="1px solid #ccc";
div.style.marginBottom="10px";
div.style.borderRadius="0"; 
div.style.overflow="hidden"; 
div.innerHTML=`<div style="padding:10px;background:${cor};color:#fff;font-weight:bold;">${d}</div>`;
items.forEach((e,i)=>{
div.innerHTML+=`
<div style="padding:10px;border-top:1px solid #eee;display:flex;justify-content:space-between;">
<div style="display:flex;gap:10px;align-items:center;">
<img src="${e.img}" style="width:30px;height:30px;object-fit:contain;">
<div>
<b>${e.maquina}</b><br>
TEMPO: ${e.tempo} MIN<br>
QUANDO FAZER: ${e.quando}
${e.obs?`<br>OBS: ${e.obs}`:""}
</div>
</div>
<button style="background:#f44336;color:#fff;border:none;padding:5px 10px;font-weight:bold;border-radius: 0;" onclick="delCardio('${d}',${i})">EXCLUIR</button>
</div>`;
});
box.appendChild(div);
});
});
}

document.getElementById("newCardio").onclick=()=>{
document.getElementById("cardioForm").style.display="block";
document.getElementById("maqInputs").innerHTML="";
document.querySelectorAll(".maq").forEach(m=>m.checked=false);
};

document.querySelectorAll(".maq").forEach(c=>{
c.onchange=()=>{
let cont=document.getElementById("maqInputs");
if(c.checked){
let id="i_"+c.value;
cont.innerHTML+=`
<div id="${id}" style="margin-top:10px;border:1px solid #ddd;padding:10px;border-radius: 0;"> <b>${c.value}</b><br>
<input placeholder="Tempo (min)" type="number" class="tempo" data-m="${c.value}" style="width:100%;padding:8px;border:1px solid:#ccc;margin-top:5px;border-radius: 0;"> <select class="quando" data-m="${c.value}" style="width:100%;padding:8px;border:1px solid:#ccc;margin-top:5px;border-radius: 0;"> <option>INÍCIO</option><option>MEIO</option><option>FIM</option>
</select>
<textarea class="obsC" data-m="${c.value}" placeholder="Observação (opcional)" style="width:100%;padding:8px;border:1px solid:#ccc;margin-top:5px;border-radius: 0;"></textarea> </div>`;
}else{
document.getElementById("i_"+c.value)?.remove();
}
};
});

document.getElementById("saveCardio").onclick=()=>{
const dia=document.getElementById("diaCardio").value;
const tempos=document.querySelectorAll(".tempo");
let salvar=[];
tempos.forEach(t=>{
let m=t.dataset.m;
let tempo=t.value;
let quando=document.querySelector(`.quando[data-m="${m}"]`).value;
let obs=document.querySelector(`.obsC[data-m="${m}"]`).value;

if(tempo){
salvar.push({
dia:dia,
maquina:m,
tempo:tempo,
quando:quando,
obs:obs,
img:imgsFixas[m],
cor:coresCardio[dia]
});
}
});

db.ref("cardio/"+na).get().then(s=>{
let data=s.exists()?s.val():[];
salvar.forEach(n=>data.push(n));
db.ref("cardio/"+na).set(data).then(()=>{
document.getElementById("cardioForm").style.display="none";
loadCardio();
});
});
};

function delCardio(d,i){
db.ref("cardio/"+na).get().then(s=>{
if(!s.exists())return;
let data=s.val();
let count=0;
data=data.filter(x=>{
if(x.dia===d){
if(count===i){count++;return false;}
count++;
}
return true;
});
db.ref("cardio/"+na).set(data).then(()=>loadCardio());
});
}
</script>


<style>
.cardio_area_custom {
    display: flex;
    width: 100%;
    justify-content: center;
    gap: 12px;
    margin-top: 18px;
    font-size: 13px;
    font-weight: 600;
    color: white;
    user-select: none;
    text-align: center;
}
.cardio_item_custom {
    cursor: pointer;
    max-width: 135px;
    line-height: 17px;
}
.cardio_divider_custom {
    opacity: 0.5;
    color: white;
}
.cardio_overlay_custom {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: white;
    display: none;
    justify-content: center;
    align-items: flex-start;
    padding-top: 60px;
    padding-left: 18px;
    padding-right: 18px;
    z-index: 999999;
}
.cardio_box_custom {
    width: 100%;
    max-width: 420px;
    font-size: 14px;
    font-weight: 500;
    color: black;
    line-height: 20px;
}
.cardio_close_custom {
    position: fixed;
    top: 15px;
    right: 15px;
    font-size: 22px;
    font-weight: 900;
    cursor: pointer;
    user-select: none;
    color: black;
}
</style>

<div class="cardio_area_custom">
    <div class="cardio_item_custom" onclick="openCardioCustom(1)">O que é intensidade?</div>
    <div class="cardio_divider_custom">•</div>
    <div class="cardio_item_custom" onclick="openCardioCustom(2)">Devo me alongar?</div>
</div>

<div id="cardioOverlayCustom" class="cardio_overlay_custom">
    <div class="cardio_close_custom" onclick="closeCardioCustom()">X</div>
    <div id="cardioContentCustom" class="cardio_box_custom"></div>
</div>

<script>
const cardioDataCustom = {
    1: { 
        titulo: "O que é intensidade?",
        descricao: "Intensidade de treino é o nível de esforço aplicado em cada exercício, variando de acordo com a carga, velocidade, descanso e técnica utilizada, influenciando diretamente nos resultados e na adaptação do corpo. Em treinos mais avançados, entram métodos como dropset, onde você reduz o peso e continua a série além da falha, elevando o estímulo muscular. Isso aumenta o estresse metabólico e a fadiga, sendo ideal para quem já possui base e controle do movimento. A intensidade certa acelera a evolução, mas deve ser aplicada com cautela para evitar lesões e garantir progresso seguro."
    },
    2: { 
        titulo: "Devo fazer alongamento?",
        descricao: "O alongamento é essencial para melhorar a flexibilidade e manter a amplitude natural dos movimentos, evitando rigidez muscular. Ele ajuda a preparar o corpo para treinos e atividades diárias, reduzindo o risco de lesões. Também contribui para aliviar tensões acumuladas, promovendo relaxamento e bem-estar geral. Com a prática constante, melhora a postura, a circulação e o desempenho nos exercícios."
    }
};

function openCardioCustom(id) {
    const data = cardioDataCustom[id];
    document.getElementById("cardioContentCustom").innerHTML = `
        <h2 style='margin-bottom:6px; font-size:17px;'>${data.titulo}</h2>
        <p>${data.descricao}</p>
    `;
    document.getElementById("cardioOverlayCustom").style.display = "flex";
}

function closeCardioCustom() {
    document.getElementById("cardioOverlayCustom").style.display = "none";
}
</script>









<main>
  
  <div id="queryNAOverlay" class="overlay" style="z-index: 50; padding-top: 20px;">
    <button class="close-btn" onclick="document.getElementById('queryNAOverlay').style.display='none';">×</button>
    
    <div style="max-width: 400px; margin: 40px auto 20px;">
        <div id="queryNAForm">
            <input type="number" id="inputNA" class="search-box" placeholder="NA DA OUTRA PESSOA">
            <button id="consultarBtn" onclick="consultarNA()">CONSULTAR</button>
        </div>
        
        <h2>Treinos de NA: <span id="consultedNAHeader" class="consulted-na">...</span></h2>
        
        <div id="queryContent">
            <div id="loadingSpinner" class="spinner"></div>
            <p id="initialMessage" style="text-align:center; padding: 20px 0; color: #777;">Aguardando consulta...</p>
            
            <button id="pegarTreinoBtn" class="bottom-btn" style="width:100%; margin-top: 0; background: var(--green); display: none;" onclick="pegarTreino()">PEGAR TREINO</button>
        </div>
    </div>
  </div>
  <input type="text" id="search" class="search-box" placeholder="PESQUISAR...">
  <div id="groups"></div>
</main>





<footer>
  <button id="createBtn" class="bottom-btn">CRIAR TREINO</button>
  <button id="viewCardBtn" class="bottom-btn" style="display:none; background: var(--firebase-orange); width: 45%;">VER PRÉVIA</button>
  <button id="viewBtn" class="bottom-btn" style="width: 45%;">MEUS TREINOS</button>
</footer>

<div class="overlay" id="overlay">
  <button class="close-btn" onclick="closeOverlay()">×</button>
  <h2>MEUS TREINOS</h2>
  <button id="clearAll">EXCLUIR TUDO</button>
  <div id="trainings"></div>
</div>

<div class="overlay" id="previewOverlay">
  <button class="close-btn" onclick="closePreview()">×</button>
  <h2>PRÉVIA DO CARD</h2>
  <div id="previewContent"></div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig={apiKey:"AIzaSyBPiznHCVkTAgx6m02bZB8b0FFaot9UkBU",authDomain:"prefeitura-de-joao-camara.firebaseapp.com",projectId:"prefeitura-de-joao-camara",storageBucket:"prefeitura-de-joao-camara.firebasestorage.app",messagingSenderId:"269299041577",appId:"1:269299041577:web:fd41b2939240e9eb476338",measurementId:"G-YT7NHR342J"};
firebase.initializeApp(firebaseConfig);

const db=firebase.database();
const na=localStorage.getItem('loggedUser')||'0000'; // NA do usuário LOGADO
let consultedNA = null; // NA do aluno CONSULTADO

// NOVO: MAPA DE CORES FIXAS POR DIA DA SEMANA
const dayColorMap = {
    "SEGUNDA": "#4CAF50", // Verde
    "TERÇA": "#2196F3", // Azul
    "QUARTA": "#FF9800", // Laranja
    "QUINTA": "#9C27B0", // Roxo
    "SEXTA": "#F44336", // Vermelho
    "SÁBADO": "#009688", // Ciano/Verde Água
    "DOMINGO": "#607D8B" // Cinza/Azul Escuro
};

// Array de cores original (Mantido, mas menos usado agora para a cor do dia)
const cores=["#4caf50","#2196f3","#ff9800","#9c27b0","#f44336","#009688","#607d8b","#8bc34a","#3f51b5","#ff5722"];
let corIndex=0; // Mantido para a lógica de "pegar treino"

const groupsData={
"MEMBROS INFERIORES – GLÚTEOS / PERNAS / PANTURRILHAS":[
"ADUÇÃO-ABDUÇÃO","GLÚTEO VERTICAL","HACK","LEG 45","LEG 90","MESA FLEXORA",
"EXTENSORA","ELEVAÇÃO PÉLVICA","AGACHAMENTO LIVRE","AGACHAMENTO GUIADO",
"CROSS SMITH","PANTURRILHA EM PÉ","PANTURRILHA SENTADA",
"BÚLGARO","AFUNDO","CADEIRA FLEXORA","AGACHAMENTO SUMÔ"
],

"MEMBROS SUPERIORES – COSTAS / DORSAIS":[
"PUXADA / REMADA BAIXA",
"PUXADA DORSAL",
"REMADA BAIXA DORSAL",
"REMADA NO APARELHO",
"REMADA CAVALINHO",

"REMADA CURVADA COM BARRA",
"REMADA CURVADA COM HALTERES",
"REMADA UNILATERAL (SERROTE)",
"PUXADA FRENTE COM TRIÂNGULO",
"PULL DOWN",
"PULLOVER"
],

"MEMBROS SUPERIORES – PEITO":[
"PECK DECK","SUPINO RETO","SUPINO INCL ARTICU","SUPINO RETO ARTICU",
"SUP INCLINADO MAQ","SUP DECLINADO",
"SUPINO DECLINADO MÁQUINA","CRUCIFIXO RETO COM HALTERES",
"CRUCIFIXO INCLINADO COM HALTERES","SUPINO RETO HALTERES",
"SUPINO INCLINADO HALTERES"
],

"MEMBROS SUPERIORES – BRAÇOS":[
"ROSCA SCOT MÁQUINA","ROSCA SCOT LIVRE",
"ROSCA DIRETA","ROSCA MARTELO",
"ROSCA ALTERNADA","ROSCA COM HALTERES - BANCO 46°","ROSCA CONCENTRADA UNILATERAL","TRÍCEPS CORDA NA POLIA","TRICEPS BARRA NA POLIA","TRICEPS FRANCÊS","TRICEPS TESTA","TRICEPS COISE UNILATERAL"
],

"MEMBROS SUPERIORES – OMBROS":[
"DESENV OMBRO LIVRE","BANCO SENTADO LIVRE","DESENVOLVIMENTO COM HALTERES","ELEVAÇÃO LATERAL","ELEVAÇÃO FRONTAL","CRUSIFIXO INVERSO","REMADA BAIXA","ENCOLHIMENTO","PUXADA / REMADA ALTA"
]
};

const intensidades=["NENHUMA","DROP-SET","SUPER-SÉRIE","TRI-SET","BI-SET","REST-PAUSE","PIRÂMIDE","GANGORRA","PRÉ-EXAUSTÃO"];

const groupsContainer=document.getElementById('groups');
const viewCardBtn = document.getElementById('viewCardBtn');
const previewOverlay = document.getElementById('previewOverlay');
const previewContent = document.getElementById('previewContent');

Object.keys(groupsData).forEach(g=>{
  const group=document.createElement('div');
  group.className='group';
  const header=document.createElement('div');
  header.className='group-header';
  header.textContent=g;

  const list=document.createElement('div');
  list.className='exercise-list';

  groupsData[g].forEach(ex=>{
    const item=document.createElement('div');
    item.className='exercise-item';
    item.innerHTML=`
      <div style="display: flex; gap: 8px; align-items: flex-start;">
        <div class="checkbox-modern"></div>
        <span>${ex}</span>
      </div>
      <div>
        <div class="input-row">
          <input class="reps" type="number" placeholder="REP" min="1">
          <input class="series" type="number" placeholder="SÉR" min="1">
          <input class="duration" type="number" placeholder="MESES" min="1">
        </div>
        <select class="day-select">
          <option>SEGUNDA</option><option>TERÇA</option><option>QUARTA</option>
          <option>QUINTA</option><option>SEXTA</option><option>SÁBADO</option><option>DOMINGO</option>
        </select>
        <select class="intensity-select">
          ${intensidades.map(i=>`<option>${i}</option>`).join('')}
        </select>
        <textarea class="obs" placeholder="Observação (opcional)"></textarea>
      </div>`;
    list.appendChild(item);
  });

  header.onclick=()=>list.style.display=list.style.display==='block'?'none':'block';
  group.appendChild(header);
  group.appendChild(list);
  groupsContainer.appendChild(group);
});

// NOVO: Atualiza a visibilidade do botão de prévia e adiciona listener
document.addEventListener('click',e=>{
  if(e.target.classList.contains('checkbox-modern')){
    e.target.classList.toggle('active');
    updatePreviewButtonVisibility();
  }
});

function updatePreviewButtonVisibility() {
    const anySelected = document.querySelector('.checkbox-modern.active');
    viewCardBtn.style.display = anySelected ? 'block' : 'none';
    
    const createBtn = document.getElementById('createBtn');
    const viewBtn = document.getElementById('viewBtn');
    
    // Ajusta a largura dos botões 'CRIAR' e 'MEUS TREINOS' se o VER PRÉVIA estiver visível
    if (anySelected) {
        createBtn.style.width = '45%';
        viewBtn.style.width = '45%';
        createBtn.style.marginRight = '0'; // Ajuste de margem se necessário
    } else {
        createBtn.style.width = '50%';
        viewBtn.style.width = '50%';
        createBtn.style.marginRight = '15px'; // Volta à margem padrão do flex
    }
}

// Inicializa a visibilidade do botão de prévia
updatePreviewButtonVisibility(); 

document.getElementById('search').addEventListener('input',e=>{
  const val=e.target.value.toUpperCase();
  document.querySelectorAll('.exercise-item').forEach(i=>{
    i.style.display=i.innerText.toUpperCase().includes(val)?'flex':'none';
  });
});

document.getElementById('createBtn').onclick=async()=>{
  const selected=[];
  document.querySelectorAll('.exercise-item').forEach(i=>{
    if(i.querySelector('.checkbox-modern').classList.contains('active')){
        const diaSelecionado = i.querySelector('.day-select').value;
        const corFixa = dayColorMap[diaSelecionado] || cores[0]; // Pega a cor fixa do dia
        
      selected.push({
        exercicio:i.querySelector('span').innerText,
        reps:i.querySelector('.reps').value,
        series:i.querySelector('.series').value,
        duracao:i.querySelector('.duration').value,
        dia:diaSelecionado,
        intensidade:i.querySelector('.intensity-select').value,
        observacao:i.querySelector('.obs').value || "",
        cor:corFixa // Usa a cor fixa do dia
      });
    }
  });

  if(!selected.length){
    alert('Nenhum exercício selecionado.');
    return;
  }

  const snap=await db.ref('treinos/'+na).get();
  let data=snap.exists()?snap.val():[];

  selected.forEach(sel=>{
    // Garante que a cor seja a cor fixa do dia para novos treinos
    const existe=data.some(x=>x.exercicio===sel.exercicio && x.dia===sel.dia);
    if(!existe) data.push(sel);
  });

  await db.ref('treinos/'+na).set(data);
  corIndex++; // Mantido, mas só afeta a cor de cópia/próximo PT
  alert('Treino criado com sucesso!');
  
  // Limpa as seleções e esconde o botão de prévia após criar
  document.querySelectorAll('.checkbox-modern.active').forEach(c => c.classList.remove('active'));
  updatePreviewButtonVisibility(); 
};

const overlay=document.getElementById('overlay');

document.getElementById('viewBtn').onclick=async()=>{
  overlay.style.display='block';
  loadTrainings();
};

// NOVO: Ação do botão de prévia
document.getElementById('viewCardBtn').onclick=()=>{
    previewOverlay.style.display='block';
    loadPreview();
};

document.getElementById('clearAll').onclick=async()=>{
  if(confirm('Deseja excluir todos os treinos?')){
    await db.ref('treinos/'+na).remove();
    document.getElementById('trainings').innerHTML='<p style="text-align:center; padding: 20px 0; color: #777;">Nenhum treino criado.</p>';
  }
};

function closeOverlay(){
  overlay.style.display='none';
}

function closePreview(){
    previewOverlay.style.display='none';
}

// ATUALIZADO: Função para carregar a prévia do treino com cores distintas por dia
function loadPreview() {
    previewContent.innerHTML = '';
    const selected = [];
    document.querySelectorAll('.exercise-item').forEach(i => {
        if (i.querySelector('.checkbox-modern').classList.contains('active')) {
            const diaSelecionado = i.querySelector('.day-select').value;
            const corFixa = dayColorMap[diaSelecionado] || 'var(--firebase-orange)'; // Cor fixa ou fallback
            
            selected.push({
                exercicio: i.querySelector('span').innerText,
                reps: i.querySelector('.reps').value,
                series: i.querySelector('.series').value,
                duracao: i.querySelector('.duration').value,
                dia: diaSelecionado,
                intensidade: i.querySelector('.intensity-select').value,
                observacao: i.querySelector('.obs').value || "",
                cor: corFixa // Usa a cor fixa do dia
            });
        }
    });

    if (selected.length === 0) {
        previewContent.innerHTML = '<p style="text-align:center; padding: 20px 0; color: #777;">Nenhum exercício selecionado para prévia.</p>';
        return;
    }

    const dias = ['SEGUNDA', 'TERÇA', 'QUARTA', 'QUINTA', 'SEXTA', 'SÁBADO', 'DOMINGO'];
    
    dias.forEach(d => {
        const items = selected.filter(x => x.dia === d);
        if (items.length > 0) {
            const sec = document.createElement('div');
            sec.className = 'day-section';
            
            // Atribui a cor fixa do dia (ou a cor do primeiro item se estiver faltando)
            const dayColor = dayColorMap[d] || items[0].cor || 'var(--firebase-orange)'; 
            sec.innerHTML = `<div class='day-title' style="background:${dayColor}">${d} (PRÉVIA)</div>`;

            items.forEach((e) => {
                const div = document.createElement('div');
                div.className = 'exercise-entry';
                
                div.innerHTML = `
                    <div class="details-container" style="max-width: 100%;">
                      <strong>${e.exercicio}</strong>
                      <div class="exercise-details">
                          SÉRIES: ${e.series} | REPETIÇÕES: ${e.reps} | DURAÇÃO: ${e.duracao} MÊS(ES)
                          <br>INTENSIDADE: ${e.intensidade}
                          ${e.observacao ? `<br><strong>OBS:</strong> ${e.observacao}` : ""}
                      </div>
                    </div>`;
                sec.appendChild(div);
            });

            previewContent.appendChild(sec);
        }
    });
}


// ATUALIZADO: Função para carregar os treinos salvos com cores distintas por dia
async function loadTrainings(){
    const tDiv=document.getElementById('trainings');
    tDiv.innerHTML='';

    const snap=await db.ref('treinos/'+na).get();
    if(!snap.exists()){
      tDiv.innerHTML='<p style="text-align:center; padding: 20px 0; color: #777;">Nenhum treino criado.</p>';
      return;
    }

    const allData=snap.val();
    const dias=['SEGUNDA','TERÇA','QUARTA','QUINTA','SEXTA','SÁBADO','DOMINGO'];

    dias.forEach(d=>{
      const items=allData.filter(x=>x.dia===d);
      if(items.length>0){
        const sec=document.createElement('div');
        sec.className='day-section';
        
        // Usa a cor fixa do dia ou a cor salva no primeiro item como fallback
        const dayColor = dayColorMap[d] || items[0].cor || cores[0];
        sec.innerHTML=`<div class='day-title' style="background:${dayColor}">${d}</div>`;

        items.forEach((e,i)=>{
          const div=document.createElement('div');
          div.className='exercise-entry';
          
          const isFirst = i === 0;
          const isLast = i === items.length - 1;
          
          div.innerHTML=`
            <div class="details-container">
              <strong>${e.exercicio}</strong>
              <div class="exercise-details">
                  SÉRIES: ${e.series} | REPETIÇÕES: ${e.reps} | DURAÇÃO: ${e.duracao} MÊS(ES)
                  <br>INTENSIDADE: ${e.intensidade}
                  ${e.observacao ? `<br><strong>OBS:</strong> ${e.observacao}` : ""}
              </div>
            </div>
            <div class="action-buttons">
                <button class="move-btn" onclick="moveUp('${d}',${i})" ${isFirst ? 'disabled' : ''}>▲</button>
                <button class="move-btn" onclick="moveDown('${d}',${i})" ${isLast ? 'disabled' : ''}>▼</button>
                <button class="delete-btn" onclick="deleteExercise('${d}',${i})"></button>
            </div>`;
          sec.appendChild(div);
        });

        tDiv.appendChild(sec);
      }
    });
}

async function deleteExercise(dia,index){
  if(!confirm('Tem certeza que deseja excluir este exercício?')) return;
  
  const snap=await db.ref('treinos/'+na).get();
  if(!snap.exists())return;

  let data=snap.val();
  let count=0;

  // Filtra o treino a ser removido (usando o índice dentro do dia)
  data=data.filter(x=>{
    if(x.dia===dia){
      if(count===index){count++;return false;}
      count++;
    }
    return true;
  });

  await db.ref('treinos/'+na).set(data);
  loadTrainings(); 
}

async function reorderExercise(dia, index, direction){
    const snap = await db.ref('treinos/' + na).get();
    if (!snap.exists()) return;

    let allData = snap.val();
    let currentDayData = allData.filter(x => x.dia === dia);
    
    const newIndex = index + direction;

    if (newIndex < 0 || newIndex >= currentDayData.length) return; // Limite

    // Encontra o item a ser movido no array do dia
    const [movedItem] = currentDayData.splice(index, 1);
    currentDayData.splice(newIndex, 0, movedItem);

    // Constrói o novo array de dados completo
    let newData = [];
    allData.forEach(item => {
        if (item.dia !== dia) {
            newData.push(item);
        }
    });
    newData.push(...currentDayData);

    // Salva no Firebase
    await db.ref('treinos/' + na).set(newData);
    loadTrainings();
}

function moveUp(dia, index) {
    reorderExercise(dia, index, -1);
}

function moveDown(dia, index) {
    reorderExercise(dia, index, 1);
}

// ==========================================================
// FUNÇÕES DE CONSULTA NA E COPIAR TREINO (ATUALIZADAS)
// ==========================================================

async function consultarNA() {
    const inputNA = document.getElementById('inputNA').value.trim();
    const queryContent = document.getElementById('queryContent');
    const pegarTreinoBtn = document.getElementById('pegarTreinoBtn');
    const consultedNAHeader = document.getElementById('consultedNAHeader');
    const loadingSpinner = document.getElementById('loadingSpinner');
    const initialMessage = document.getElementById('initialMessage');
    
    // 1. Limpa o conteúdo anterior e mostra o spinner
    queryContent.innerHTML = '';
    queryContent.appendChild(loadingSpinner);
    loadingSpinner.style.display = 'block';
    pegarTreinoBtn.style.display = 'none';
    consultedNAHeader.innerText = inputNA;
    consultedNA = inputNA;

    if (!inputNA) {
        loadingSpinner.style.display = 'none';
        queryContent.innerHTML = '<p style="text-align:center; padding: 20px 0; color: #F44336; font-weight: bold;">Por favor, insira um NA.</p>';
        return;
    }

    if (inputNA === na) {
        loadingSpinner.style.display = 'none';
        queryContent.innerHTML = '<p style="text-align:center; padding: 20px 0; color: #F44336; font-weight: bold;">Este é o seu próprio NA!</p>';
        return;
    }
    
    // Mostra o NA de quem está logado/consultando no topo do overlay
    document.getElementById('queryNAOverlay').querySelector('h2').innerHTML = `Treinos de ${consultedNA} <span class="consulted-na">(Consultado por NA: ${na})</span>`;

    // 2. Realiza a consulta (simula um tempo de espera para ver o spinner)
    const snap = await db.ref('treinos/' + inputNA).get();

    // 3. Esconde o spinner
    loadingSpinner.style.display = 'none';

    if (!snap.exists() || snap.val().length === 0) {
        queryContent.innerHTML = `<p style="text-align:center; padding: 20px 0; color: #777;">O aluno **${inputNA}** não possui treinos cadastrados.</p>`;
        return;
    }

    const allData = snap.val();
    const dias = ['SEGUNDA', 'TERÇA', 'QUARTA', 'QUINTA', 'SEXTA', 'SÁBADO', 'DOMINGO'];
    
    // 4. Cria um novo container para os treinos
    const trainingsContainer = document.createElement('div');
    
    // 5. Adiciona o botão de cópia NO TOPO do container de treinos
    pegarTreinoBtn.style.display = 'block';
    trainingsContainer.appendChild(pegarTreinoBtn);
    
    // 6. Renderiza os treinos do NA consultado
    dias.forEach(d => {
        const items = allData.filter(x => x.dia === d);
        if (items.length > 0) {
            const sec = document.createElement('div');
            sec.className = 'day-section';
            
            // Cor de destaque (secondary-color) para indicar que é um treino consultado
            sec.innerHTML = `<div class='day-title' style="background:var(--secondary-color)">${d} (NA: ${inputNA})</div>`;

            items.forEach((e) => {
                const div = document.createElement('div');
                div.className = 'exercise-entry';
                
                div.innerHTML = `
                    <div class="details-container" style="max-width: 100%;">
                      <strong>${e.exercicio}</strong>
                      <div class="exercise-details">
                          SÉRIES: ${e.series} | REPETIÇÕES: ${e.reps} | DURAÇÃO: ${e.duracao} MÊS(ES)
                          <br>INTENSIDADE: ${e.intensidade}
                          ${e.observacao ? `<br><strong>OBS:</strong> ${e.observacao}` : ""}
                      </div>
                    </div>`;
                sec.appendChild(div);
            });

            trainingsContainer.appendChild(sec);
        }
    });
    
    // 7. Substitui o conteúdo da queryContent pelo novo container
    queryContent.innerHTML = '';
    queryContent.appendChild(trainingsContainer);
}

async function pegarTreino() {
    if (!consultedNA) {
        alert('Nenhum NA consultado para pegar o treino.');
        return;
    }
    
    if (!confirm(`Deseja COPIAR todos os treinos do aluno NA: ${consultedNA} para o seu NA: ${na}?`)) {
        return;
    }

    const snapConsultado = await db.ref('treinos/' + consultedNA).get();
    if (!snapConsultado.exists()) {
        alert('Erro: Treino do aluno consultado não encontrado.');
        return;
    }

    const treinosConsultado = snapConsultado.val();
    const snapLogado = await db.ref('treinos/' + na).get();
    let treinosLogado = snapLogado.exists() ? snapLogado.val() : [];
    
    
    const treinosParaAdicionar = treinosConsultado.map(treino => ({
        ...treino,
        // Garante que a cor seja a cor fixa do dia para o aluno que está copiando
        cor: dayColorMap[treino.dia] || cores[0] 
    }));

    // Filtra para não adicionar treinos duplicados (mesmo exercício no mesmo dia)
    treinosParaAdicionar.forEach(novoTreino => {
        const existe = treinosLogado.some(
            t => t.exercicio === novoTreino.exercicio && t.dia === novoTreino.dia
        );
        if (!existe) {
            treinosLogado.push(novoTreino);
        }
    });

    // Salva os treinos atualizados para o usuário logado
    await db.ref('treinos/' + na).set(treinosLogado);
    
    corIndex++; // Mantido
    document.getElementById('queryNAOverlay').style.display='none'; // Fecha o overlay
    
    alert(`Treino do NA: ${consultedNA} copiado com sucesso para o seu NA: ${na}!`);
}
</script>

</body>
</html>








<div id="overlay">
    <div id="notificacao">
        <img id="imgNotif" src="https://c2a6771173.cbaul-cdnwnd.com/4f0c8b93cda84ae8665e2b589652cf30/200000129-a0260a0261/3C5A07C7-4F32-488B-B0AB-53E57B97E1E8.webp" alt="Notificação">
        <div class="botoes">
            <button id="acessarBtn">Ver cursos</button>
            <button id="fecharBtn">Fechar</button>
        </div>
    </div>
</div>

<style>
    /* Impede qualquer flash na abertura */
    #overlay {
        position: fixed !important;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0,0,0,0.6);
        display: none; /* ← evita aparecer antes da hora */
        justify-content: center;
        align-items: center;
        opacity: 0;
        transition: opacity .3s ease;
        z-index: 999999 !important; /* isolado para não interferir */
    }

    #notificacao {
        background: #ffffff;
        padding: 20px;
        width: 320px;
        border-radius: 0; /* quadrado */
        text-align: center;
        box-shadow: 0 0 20px rgba(0,0,0,0.3);
    }

    #notificacao img {
        width: 100%;
        border-radius: 0; /* quadrado */
        margin-bottom: 15px;
    }

    .botoes {
        display: flex;
        justify-content: space-between;
        gap: 10px;
    }

    button {
        flex: 1;
        padding: 10px;
        border: 2px solid #000; /* borda quadrada */
        border-radius: 0; /* quadrado */
        cursor: pointer;
        font-size: 15px;
        font-weight: bold;
    }

    #acessarBtn {
        background: #28a745;
        color: #fff;
    }

    #fecharBtn {
        background: #dc3545;
        color: #fff;
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const overlay = document.getElementById("overlay");

        /* Agora aparece imediatamente e sem flash */
        overlay.style.display = "flex";
        requestAnimationFrame(() => {
            overlay.style.opacity = "1";
        });
    });

    document.getElementById("acessarBtn").onclick = function() {
        window.location.href = "https://domusfit.site/cursos.html";
    };

    document.getElementById("fecharBtn").onclick = function() {
        const overlay = document.getElementById("overlay");
        overlay.style.opacity = "0";
        setTimeout(() => {
            overlay.style.display = "none";
        }, 300);
    };
</script>