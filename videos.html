<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Biblioteca Virtual — Ouvidoria</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--header-h:64px;--max-w:1000px}
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;width:100%;font-family:"Public Sans",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  body{min-height:100vh;background:#041739;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:#fff}
  header{position:fixed;top:0;left:0;right:0;height:var(--header-h);z-index:1100;background:#fff;color:#333;display:flex;align-items:center;justify-content:space-between;padding:12px 18px;box-shadow:0 2px 6px rgba(0,0,0,.08)}
  header .logo{display:flex;align-items:center;gap:12px}
  header .logo img{width:44px;height:44px;object-fit:contain;border-radius:8px}
  header .logo div{display:flex;flex-direction:column}
  header strong{font-size:15px}
  header small{font-size:13px;color:#444}
  .btn-back{background:#0b2b6b;color:#fff;width:40px;height:40px;display:flex;align-items:center;justify-content:center;text-decoration:none;font-size:20px;border:none;border-radius:6px}
  main{margin:0 auto;max-width:var(--max-w);padding:20px;margin-top:calc(var(--header-h) + 10px);color:#fff;min-height:calc(100vh - (var(--header-h) + 20px));animation:fadeIn 1.2s ease}
  h1,h2,p,.contato{animation:slideUp .8s ease both}
  h1{font-size:22px;margin-bottom:14px;animation-delay:.1s}
  h2{font-size:18px;margin:20px 0 10px;animation-delay:.2s}
  p{margin-bottom:12px;line-height:1.6;animation-delay:.3s}
  a{color:#fff;text-decoration:underline}
  .contato{margin-bottom:20px;padding:14px;border:1px solid rgba(255,255,255,.2);border-radius:10px;background:rgba(255,255,255,.05);display:flex;flex-direction:column;gap:12px;animation-delay:0s}
  .contato-item{display:flex;align-items:center;gap:10px}
  .contato-item img{width:22px;height:22px;object-fit:contain}
  .contato strong{display:block;margin:0}
  @keyframes fadeIn{from{opacity:0}to{opacity:1}}
  @keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<header>
  <div class="logo">
    <img id="logoHeader" src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQcf-AtSCrU4sQ8PORTd7uRTwMwR1mzoxn5NMWhhAKbE2dsKY6Uiu17i5U7&s=10" alt="Logo">
    <div>
      <strong>Videos e trasmissões</strong>
      <small>Câmara Municipal de João Câmara</small>
    </div>
  </div>
  <a href="perfil.html" class="btn-back" aria-label="Voltar">←</a>
</header>






<br><br><br>

<style>
/* Embeds sem borda (para inserir em outro site). Não inclua <body> ou <!DOCTYPE>. */
#jc-videos-root{box-sizing:border-box;background:#fff;color:#0b2f6b;font-family:Arial,Helvetica,sans-serif;padding:12px}
#jc-videos-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px}
.jc-thumb{position:relative;cursor:pointer;overflow:hidden;border-radius:6px;background:#fff}
.jc-thumb img{display:block;width:100%;height:auto;max-height:140px;object-fit:cover}
.jc-thumb .meta{padding:8px 6px}
.jc-title{font-style:italic;color:#0b2f6b;font-size:14px;line-height:1.2;margin:0 0 6px}
.jc-date{font-size:12px;color:#6b7280;margin:0}
.jc-live-badge{position:absolute;left:8px;top:8px;background:#e60000;color:#fff;padding:4px 6px;font-size:12px;border-radius:4px;font-weight:600;z-index:3}
.jc-live-frame{border:3px solid #e60000;border-radius:6px}
#jc-player-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;z-index:99998;visibility:hidden;opacity:0;transition:opacity .18s}
#jc-player-overlay.show{visibility:visible;opacity:1}
#jc-player-container{width:min(1100px,96%);height:min(640px,86%);background:#000;border-radius:8px;overflow:hidden;display:flex;flex-direction:column}
#jc-close{align-self:flex-end;color:#fff;background:transparent;border:0;font-size:18px;padding:8px;cursor:pointer}
#jc-player-iframe{width:100%;height:100%;border:0;flex:1}
#jc-header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
#jc-title-header{font-size:18px;color:#0b2f6b;font-style:italic;margin:0}
#jc-sub{font-size:13px;color:#6b7280;margin:0}
@media(max-width:520px){
  #jc-videos-grid{grid-template-columns:repeat(2,1fr);gap:10px}
  .jc-thumb img{max-height:110px}
}
</style>

<div id="jc-videos-root" aria-live="polite">
  <div id="jc-header">
    <div style="flex:1">
      <h3 id="jc-title-header">Câmara Municipal de João Câmara — Vídeos</h3>
      <p id="jc-sub">Carregando vídeos...</p>
    </div>
  </div>

  <div id="jc-videos-grid" role="list" aria-label="Lista de vídeos"></div>
</div>

<!-- Player overlay -->
<div id="jc-player-overlay" role="dialog" aria-hidden="true">
  <div id="jc-player-container" role="document">
    <button id="jc-close" aria-label="Fechar player">✕</button>
    <iframe id="jc-player-iframe" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
  </div>
</div>

<script>
/*
  INSTRUÇÕES: cole este bloco onde desejar incorporar. NÃO adiciona borda externa no container.
  Channel ID detectado (confirmado): UCAxJy7UXbU8KaJIctI1v6ow
  API KEY fornecida pelo usuário (já inclusa abaixo).
*/
(function(){
  const API_KEY = 'AIzaSyDS9f8LJEx1CFkDdmVF5AoK02hkNvxBCEE'; // fornecida por você
  const CHANNEL_ID = 'UCAxJy7UXbU8KaJIctI1v6ow';

  const root = document.getElementById('jc-videos-root');
  const grid = document.getElementById('jc-videos-grid');
  const sub = document.getElementById('jc-sub');
  const overlay = document.getElementById('jc-player-overlay');
  const iframe = document.getElementById('jc-player-iframe');
  const closeBtn = document.getElementById('jc-close');

  // Abre player (embed). se live=true adiciona borda vermelha no thumb já aplicada no elemento
  function openPlayer(videoId, live=false){
    overlay.classList.add('show');
    overlay.setAttribute('aria-hidden','false');
    // autoplay=1 para abrir direto em tempo real se suportado
    iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&rel=0`;
    // adiciona classe de borda quando for live
    const playerContainer = document.getElementById('jc-player-container');
    if(live){
      // destaque interno no player
      playerContainer.style.border = '3px solid #e60000';
    } else {
      playerContainer.style.border = '0';
    }
  }
  function closePlayer(){
    overlay.classList.remove('show');
    overlay.setAttribute('aria-hidden','true');
    iframe.src = '';
    document.getElementById('jc-player-container').style.border = '0';
  }
  closeBtn.addEventListener('click', closePlayer);
  overlay.addEventListener('click', function(e){
    if(e.target === overlay) closePlayer();
  });

  // Helper: fetch JSON
  async function fetchJSON(url){ const r = await fetch(url); if(!r.ok) throw new Error('HTTP '+r.status); return r.json(); }

  // 1) Check if any live stream is active RIGHT NOW for the channel
  async function fetchLive(){
    const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&channelId=${CHANNEL_ID}&eventType=live&type=video&key=${API_KEY}`;
    try{
      const data = await fetchJSON(url);
      if(Array.isArray(data.items) && data.items.length>0){
        // return first live item
        return data.items[0];
      }
    }catch(err){
      console.warn('Erro ao checar live:',err);
    }
    return null;
  }

  // 2) Get uploads playlist id from channel contentDetails
  async function getUploadsPlaylistId(){
    const url = `https://www.googleapis.com/youtube/v3/channels?part=contentDetails&id=${CHANNEL_ID}&key=${API_KEY}`;
    const data = await fetchJSON(url);
    if(data.items && data.items[0] && data.items[0].contentDetails &&
       data.items[0].contentDetails.relatedPlaylists && data.items[0].contentDetails.relatedPlaylists.uploads){
      return data.items[0].contentDetails.relatedPlaylists.uploads;
    }
    throw new Error('Uploads playlist não encontrada');
  }

  // 3) Fetch all videos from uploads playlist (paginado). retorna array de items (snippet)
  async function fetchAllUploads(playlistId){
    let items = [];
    let pageToken = '';
    try{
      do{
        const url = `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${playlistId}&key=${API_KEY}` + (pageToken?`&pageToken=${pageToken}`:'');
        const data = await fetchJSON(url);
        if(data.items) items = items.concat(data.items);
        pageToken = data.nextPageToken || '';
      } while(pageToken);
    }catch(err){
      console.warn('Erro ao buscar uploads:',err);
    }
    return items;
  }

  // Render thumbnails grid
  function renderGrid(videos, liveItem){
    grid.innerHTML = '';
    // If live present, render it first with live badge and special class
    if(liveItem){
      const v = liveItem;
      const id = v.id.videoId || (v.id && v.id);
      const thumbUrl = v.snippet.thumbnails && (v.snippet.thumbnails.high?.url || v.snippet.thumbnails.medium?.url || v.snippet.thumbnails.default?.url);
      const el = document.createElement('div');
      el.className = 'jc-thumb jc-live-frame';
      el.setAttribute('role','listitem');
      el.innerHTML = `
        <div class="jc-live-badge">AO VIVO</div>
        <img src="${thumbUrl}" alt="${escapeHtml(v.snippet.title)}">
        <div class="meta">
          <h4 class="jc-title">${escapeHtml(v.snippet.title)}</h4>
          <p class="jc-date">${formatDate(v.snippet.publishedAt)} • TRANSMISSÃO AO VIVO</p>
        </div>
      `;
      el.addEventListener('click', ()=>openPlayer(id,true));
      grid.appendChild(el);
    }

    // Then render uploaded videos
    videos.forEach(item=>{
      // some playlistItems have snippet.resourceId.videoId
      const sn = item.snippet;
      const videoId = (sn.resourceId && sn.resourceId.videoId) || (item.id && item.id.videoId) || (item.id && item.id);
      const thumb = sn.thumbnails && (sn.thumbnails.medium?.url || sn.thumbnails.high?.url || sn.thumbnails.default?.url);
      const div = document.createElement('div');
      div.className = 'jc-thumb';
      div.setAttribute('role','listitem');
      div.innerHTML = `
        <img src="${thumb}" alt="${escapeHtml(sn.title)}">
        <div class="meta">
          <h4 class="jc-title">${escapeHtml(sn.title)}</h4>
          <p class="jc-date">${formatDate(sn.publishedAt)}</p>
        </div>
      `;
      div.addEventListener('click', ()=>openPlayer(videoId,false));
      grid.appendChild(div);
    });

    // summary
    sub.textContent = `${videos.length + (liveItem?1:0)} vídeos carregados — Fonte: Câmara Municipal de João Câmara`;
  }

  // small helpers
  function formatDate(iso){
    if(!iso) return '';
    const d = new Date(iso);
    return d.toLocaleDateString();
  }
  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, function(m){return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m];}); }

  // main flow: check live first, then load uploads and render
  (async function init(){
    try{
      // 1 Live check
      const live = await fetchLive();

      // 2 Uploads playlist
      const uploadsId = await getUploadsPlaylistId();

      // 3 Fetch uploads (paginated)
      const uploads = await fetchAllUploads(uploadsId);

      // map to simplified snippets (keep newest first as returned)
      const videos = uploads.map(i=>i).filter(Boolean);

      // Render UI
      renderGrid(videos, live);

      // If there is a live now - automatically open it? (The user requested: "quando entrar, ele carrega em tempo real" - we will show live visibly.
      // We will NOT auto-open the player to avoid surprising the visitor, but it is highlighted. If you prefer auto-open, uncomment below:
      // if(live){ openPlayer(live.id.videoId || live.id,true); }
    }catch(err){
      console.error(err);
      sub.textContent = 'Erro ao carregar vídeos.';
    }
  })();

})();
</script>

<div id="overlay">
  <div class="alert-box">
    <div class="spinner"></div>
    <p>Carregando</p>
  </div>
</div>

<style>
#overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.2);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;
}
.alert-box {
  background: #fff;
  padding: 25px 40px;
  border-radius: 0;
  display: flex;
  flex-direction: column;
  align-items: center;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}
.spinner {
  border: 6px solid #f3f3f3;
  border-top: 6px solid #001f4d;
  border-radius: 50%;
  width: 45px;
  height: 45px;
  animation: spin 1s linear infinite;
  margin-bottom: 10px;
}
@keyframes spin {
  0% { transform: rotate(0deg);}
  100% { transform: rotate(360deg);}
}
.alert-box p {
  margin: 0;
  font-size: 18px;
  font-weight: bold;
  color: #000;
}
</style>

<script>
window.onload = () => {
  setTimeout(() => {
    document.getElementById("overlay").style.display = "none";
  }, 3000);
};
</script>