<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Perfil do Vereador</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --header-h:64px;
    --max-w:900px;
  }

  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%;width:100%;font-family:"Public Sans",system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
  body{
    min-height:100vh;
    background:#fff;
    background-image:url("https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQM-JuQwVaQIYwKRl4Tr1Y82SzgpVltIcOR74Xauduq6QDql9cQFOzRK5e_&s=10");
    background-size:cover;background-position:center;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    color:#0a1733;
  }

  header{
    position:fixed;
    top:0;left:0;right:0;
    height:var(--header-h);
    z-index:1100;
    background:#fff;color:#333;
    display:flex;align-items:center;justify-content:space-between;
    padding:12px 18px;box-shadow:0 2px 6px rgba(0,0,0,.08);
  }
  header .logo{display:flex;align-items:center;gap:12px}
  header .logo img{width:44px;height:44px;object-fit:contain;border-radius:8px}
  header .logo div{display:flex;flex-direction:column}
  header strong{font-size:15px}
  header small{font-size:13px;color:#444}
  .btn-back{
    background:#0b2b6b;color:#fff;
    width:40px;height:40px;
    display:flex;align-items:center;justify-content:center;
    text-decoration:none;font-size:20px;border:none;border-radius:6px;
  }

  main{
    margin:0 auto;
    max-width:var(--max-w);
    padding:20px;
    margin-top: calc(var(--header-h) + 20px);
    background:linear-gradient(180deg,#0b2b6b 0%,#041739 100%);
    color:#fff;
    min-height:calc(100vh - (var(--header-h) + 20px));
  }

  .hero{position:relative;margin:16px 0;border-radius:16px;overflow:hidden;box-shadow:0 8px 20px rgba(0,0,0,.12)}
  .hero .bg{width:100%;height:200px;background:#0a1733 center/cover no-repeat;filter:brightness(.85)}
  .hero .overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0) 35%,rgba(0,0,0,.45) 100%)}

  .card{
    background:#fff;color:#0a1733;border-radius:18px;padding:22px;
    margin-top:-48px;position:relative;
    box-shadow:0 10px 28px rgba(10,42,102,.08);
    transition:all .3s;
  }
  .card:hover{box-shadow:0 14px 32px rgba(10,42,102,.12)}

  .row{display:flex;gap:20px;flex-wrap:wrap;align-items:center}
  .avatar{width:128px;height:128px;border-radius:50%;object-fit:cover;box-shadow:0 8px 18px rgba(0,0,0,.18);border:5px solid #fff;transition:transform .3s}
  .avatar:hover{transform:scale(1.04)}

  .name{font-size:26px;font-weight:900;margin:0;color:#0a1733}
  .meta{color:#4a5d85;margin:10px 0;font-weight:500}

  .section{margin-top:18px}
  .label{font-size:13px;text-transform:uppercase;letter-spacing:.4px;color:#607399;font-weight:600;margin-bottom:4px}
  .value{font-size:15px;line-height:1.5;color:#1c2b4d}

  .chips{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px}
  .chip{border:0;background:#f2f6ff;padding:9px 12px;border-radius:20px;font-size:14px;font-weight:600;color:#0a2a66;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.1);transition:all .25s;text-decoration:none;display:inline-flex;align-items:center;justify-content:center}
  .chip:hover{background:#e7ecf5;transform:translateY(-1px)}

  .loading{position:fixed;inset:0;background:#0a1733cc;backdrop-filter:blur(3px);display:none;align-items:center;justify-content:center;z-index:2000}
  .spinner{width:66px;height:66px;border:6px solid #ffffff33;border-top-color:#fff;border-radius:50%;animation:spin .9s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  .toast{position:fixed;right:18px;bottom:18px;display:flex;flex-direction:column;gap:12px;z-index:3000}
  .toast .item{background:#0a2a66;color:#fff;padding:13px 15px;border-radius:10px;border:1px solid #0e387f;box-shadow:0 10px 24px rgba(0,0,0,.25);font-weight:500;animation:fadein .3s ease}
  @keyframes fadein{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
  <header>
    <div class="logo">
      <img id="logoHeader" src="" alt="Logo">
      <div>
        <strong id="nomeHeader">Perfil do Vereador</strong>
        <small>Câmara Municipal de João Câmara</small>
      </div>
    </div>
    <a href="vereador.html" class="btn-back" aria-label="Voltar">←</a>
  </header>

  <main>
    <section class="hero">
      <div id="heroBg" class="bg"></div>
      <div class="overlay"></div>
    </section>
    <article class="card">
      <div class="row">
        <img id="foto" class="avatar" alt="Foto"/>
        <div>
          <h1 id="nome" class="name">—</h1>
          <div id="partido" class="meta"></div>
          <div class="chips">
            <a id="insta" class="chip" target="_blank" style="display:none">Instagram</a>
            <a id="tel" class="chip" href="#" style="display:none">Telefone</a>
          </div>
        </div>
      </div>
      <div class="section">
        <div class="label">Sobre</div>
        <div id="sobre" class="value">—</div>
      </div>
      <div class="section">
        <div class="label">Projetos aprovados</div>
        <div id="projetos" class="value">—</div>
      </div>
    </article>
  </main>

  <div class="loading" id="loading"><div class="spinner" role="status" aria-live="polite" aria-label="Carregando"></div></div>
  <div class="toast" id="toast"></div>

  <div vw class="enabled"><div vw-access-button class="active"></div><div vw-plugin-wrapper><div class="vw-plugin-top-wrapper"></div></div></div>

  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="script.js"></script>

  <script>
    const $=s=>document.querySelector(s);
    const showLoad=v=>$("#loading").style.display=v?"flex":"none";
    const toast=m=>{const el=document.createElement("div");el.className="item";document.body.querySelector(".toast")?.appendChild(el);el.textContent=m;setTimeout(()=>el.remove(),3800);}
    const getParam=k=>new URL(location.href).searchParams.get(k);

    showLoad(true);
    window.addEventListener("load",()=>{
      try{
        const db=firebase.database();
        firebase.database().ref("/config").on("value",snap=>{
          const c=snap.val()||{};
          $("#logoHeader").src=c.logoUrl||"";
          $("#heroBg").style.backgroundImage=c.heroUrl?`url('${c.heroUrl}')`:"";
        });
        const id=getParam("id");
        if(!id){showLoad(false);toast("ID não informado.");return;}
        db.ref(`/vereadores/${id}`).on("value",snap=>{
          const v=snap.val();
          if(!v){showLoad(false);toast("Vereador não encontrado.");return;}
          $("#foto").src=v.fotoUrl||"";
          $("#foto").alt=`Foto de ${v.nome||''}`;
          $("#nome").textContent=v.nome||"—";
          $("#nomeHeader").textContent=v.nome||"Perfil do Vereador";
          $("#partido").textContent=v.partido?`Partido: ${v.partido}`:"";
          $("#sobre").textContent=v.sobre||"—";
          $("#projetos").textContent=(v.projetosAprovados??"—");
          const i=$("#insta"); if(v.insta){i.style.display="inline-flex";i.href=`https://instagram.com/${v.insta.replace('@','')}`}
          const t=$("#tel"); if(v.telefone){t.style.display="inline-flex";t.href=`tel:${v.telefone}`;}
          showLoad(false);
        },err=>{console.error(err);showLoad(false);toast("Erro ao carregar dados.")});
      }catch(e){console.error(e);showLoad(false);toast("Erro de inicialização Firebase.");}
    });
  </script>
  <script>new window.VLibras.Widget('https://vlibras.gov.br/app');</script>
</body>
</html>